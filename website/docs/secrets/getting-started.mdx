---
title: Getting Started
hide_title: true
---

import TierLabel from "./../_components/TierLabel";
import AlphaWarning from "../_components/_alpha_warning.mdx";

# Getting started with secrets management <TierLabel tiers="Enterprise" />

<AlphaWarning/>

This guide shows you a basic experience to get started with Weave Gitops Secrets.
It covers the scenario of setting up the capability in a test environment and how to use it for your applications.

## Requirements
- You have a test Weave Gitops Enterprise environment with Flux installed.
- You have a secret in AWS secrets manager.

## Add the secrets infra

In order to be able to manage external secrets stores and secrets, add `external-secrets` application from `weaveworks-charts` profiles repository.

![add infra profile](imgs/getting-started-add-infra.png)

:::tip
[Here](../../../cluster-management/add-applications) you could refresh how to add applications.
:::

Review and merge the PR and see it available in your cluster

![infra profile reconciled](imgs/getting-started-setup-infra.png)

## Connect your secrets store

In order to connect to your secrets stores, add `secrets-store-config` application with the values for your store.

![add secrets store](imgs/getting-started-add-infra2.png)

<details><summary>Expand to see values</summary>

```yaml
  values:
    secretStores:
     aws-secrets-manager:
         provider:
           aws:
             service: SecretsManager
             region: eu-north-1
             auth:
               secretRef:
                 accessKeyIDSecretRef:
                   name: awssm-secret
                   key: access-key
                 secretAccessKeySecretRef:
                   name: awssm-secret
                   key: secret-access-key
```
</details>

And see it available in your cluster

![setup secret stores](imgs/getting-started-setup-config.png)

## Create the secret

Given you have a secret in AWS Secrets Manager for example `test/search/db`.

![aws secret](imgs/getting-started-secret-asm.png)

Create the External Secret manifest via [Secrets UI](./manage-secrets-ui.mdx) to pull the secret from your store into your environment.

![external secret](imgs/getting-started-create-secret-manifest.png)

See it available in your cluster.

![setup secret stores](imgs/getting-started-secret.png)

## Use the secret

At this stage you have everything you need for your application to [consume the secret](https://kubernetes.io/docs/concepts/configuration/secret/#using-a-secret).
Add it to your application as usual.

<details><summary>Expand to see example</summary>

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secret-dotfiles-pod
spec:
  volumes:
  - name: database-secrets
    secret:
      secretName: search-database
  containers:
  - name: dotfile-test-container
    image: registry.k8s.io/busybox
    command:
    - ls
    - "-l"
    - "/etc/database-secrets"
    volumeMounts:
    - name: database-secrets
      readOnly: true
      mountPath: "/etc/database-secrets"
```
</details>

You could see the expected secret available

```bash
kubectl logs -f secret-dotfiles-pod

total 0
lrwxrwxrwx    1 root     root            15 Apr  5 17:26 password -> ..data/password
```

## Next steps?

- For other setup scenarios using external secrets, see [setup ESO](./setup-eso.mdx)
- For SOPS secrets, see [setup SOPS](./setup-sops.mdx)
- To discover the UI capabilities to manage secrets, see [here](./manage-secrets-ui.mdx)
